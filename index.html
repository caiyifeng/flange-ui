<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
    <title></title>
    <script src="js/mui.min.js"></script>
    <link href="css/mui.min.css" rel="stylesheet"/>
    <script type="text/javascript" charset="utf-8">
    	var responseEl = document.getElementById("response");
    	var datas=[];
      	mui.init({
			swipeBack: false,
			beforeback: function() {
				mui.plusReady(function() {
					plus.screen.lockOrientation("portrait-primary"); 
				});
				return true;
			}
			
/*			不需要下拉，下拉的功能，暂时屏蔽
 * 			pullRefresh: {
				container: '#pullrefresh',
				down: {
					callback: pulldownRefresh
				},
				up: {
					contentrefresh: '正在加载...',
					callback: pullupRefresh
				}
			}
*/      	});
		/**
		 * 下拉刷新具体业务实现
		 */
		function pulldownRefresh() {
			setTimeout(function() {
				var table = document.body.querySelector('.mui-table-view');
				var cells = document.body.querySelectorAll('.mui-table-view-cell');
				alert(cells.length);
				for (var i = cells.length, len = i + 3; i < len; i++) {
					var li = document.createElement('li');
					li.className = 'mui-table-view-cell';
					li.innerHTML = '<a class="mui-navigate-right">Item ' + (i + 1) + '</a>';
				//下拉刷新，新纪录插到最前面；
					table.insertBefore(li, table.firstChild);
				}
					mui('#pullrefresh').pullRefresh().endPulldownToRefresh(); //refresh completed
			}, 1000);
		}
		var count = 0;
		/**
		 * 上拉加载具体业务实现
		 */
		function pullupRefresh() {
			setTimeout(function() {
				mui('#pullrefresh').pullRefresh().endPullupToRefresh((++count > 2)); //参数为true代表没有更多数据了。
				var table = document.body.querySelector('.mui-table-view');
				var cells = document.body.querySelectorAll('.mui-table-view-cell');
				for (var i = cells.length, len = datas.length; i < len; i++) {
					var li = document.createElement('li');
					li.className = 'mui-table-view-cell';
					li.id = "'" + datas[i]['id'] + "'";
					li.innerHTML = '<a class="mui-navigate-right">' + datas[i]['name'] + '</a>';
					table.appendChild(li);
				}
			}, 1000);
		}
      	
		mui.plusReady(function(){
			plus.screen.lockOrientation("landscape-primary") ;
			mui.get('file/cata_1.json', function(data) {
/*        		console.log("获取数据为："+ JSON.stringify(data["first_cata"]));
 * 
 */
				var table = document.body.querySelector('.mui-table-view');
	
				var items = data["first_item"];
        		for (var i in items) {
        			datas.push(items[i]);
        		}
        		var itemCount = Math.ceil(datas.length/6);
        		
        		console.log("itemCount=======" + itemCount);
        		for (var i=1;i<=itemCount;i++) {
	                var list_html = "";
	                var divId = "item"+i;
	                var beg = (i-1) * 7;
	                var end = beg + 7;
	                if (end > datas.length) {
	                	end = datas.length
	                }
    	            for (var j = beg ;j< end  ;j++)
        	        {
            	        list_html += "<li class='mui-table-view-cell' id='";
                	    list_html += datas[j];
                    	list_html += "' style='height:40px;'>";
                    	list_html += "<a class=\"mui-navigate-right\" onclick=\"openItem('"
                    	list_html += datas[j] + "');\">"
                    	list_html += datas[j] + "\"";
                    	list_html += "</a>";
                    	list_html += "</li>";  
                	}
        			document.getElementById(divId).innerHTML = list_html;
        		}
 //               document.getElementById("item").innerHTML = list_html;
        		
    		}, 'json');			
			
                
                
                 //根据数据动态拼接html代码  但是我觉得有更好的方法
            });
        
         function openItem(e) {
         	
         	plus.storage.setItem('image_first_cata',e);
			mui.openWindow({
				url: "item2.html",
				id:  "item2"
			})
        }
         
    </script>
</head>
<body>
		<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<div style="margin-left: 150px;">
				<img id="img2"  src = "images/company.png" style="width:13%;">
			</div>
		</header>
<div id="pullrefresh" class="mui-content mui-scroll-wrapper"  style="background-color:#FFFFFF">
	<div class="mui-row " >
		<div class="mui-col-sm-3 mui-col-xs-3" >
		<ul class="mui-table-view mui-table-view-chevron" id="item1">

        
		</ul>

		    
		</div>
		<div class="mui-col-sm-3 mui-col-xs-3">
		<ul class="mui-table-view mui-table-view-chevron"  id="item2">

        
		    </ul>			
		</div>
		<div class="mui-col-sm-3 mui-col-xs-3">
		<ul class="mui-table-view mui-table-view-chevron"  id="item3">

        
		    </ul>			
		</div>
		<div class="mui-col-sm-3 mui-col-xs-3">
		<ul class="mui-table-view mui-table-view-chevron"  id="item4">

        
		    </ul>			
		</div>
		
	</div>
</div>
</body>
</html>